<!-- DEFINITIVE FILE: templates/student/partials/_lms_pane.html -->
{% load humanize student_filters %}

<!-- =================================================================== -->
<!-- 1. "MY LEARNING" SECTION (ENROLLED COURSES) -->
<!-- =================================================================== -->
<div class="card shadow-sm mb-4">
    <div class="card-header bg-light">
        <h5 class="mb-0"><i class="bi bi-collection-play-fill me-2 text-primary"></i>My Learning</h5>
    </div>
    <div class="card-body">
        {% if lms_current_internal_enrollments or lms_external_enrollments %}
            <h6 class="text-muted fw-bold mb-3 text-uppercase small">Current Courses</h6>
            <div class="list-group">
                {% for enrollment in lms_current_internal_enrollments %}
                    <a href="{% url 'lsalms:course_detail' slug=enrollment.course.slug %}" class="list-group-item list-group-item-action d-flex align-items-center">
                        <div class="quest-icon-sm bg-primary-subtle text-primary me-3"><i class="bi bi-building"></i></div>
                        <div class="flex-grow-1"><strong class="d-block">{{ enrollment.course.title }}</strong><small class="text-muted">{{ enrollment.course.teacher.get_full_name }}</small></div>
                        <i class="bi bi-chevron-right text-muted"></i>
                    </a>
                {% endfor %}
                {% for enrollment in lms_external_enrollments %}
                    <a href="{% url 'lsalms:course_detail' slug=enrollment.course.slug %}" class="list-group-item list-group-item-action d-flex align-items-center">
                        <div class="quest-icon-sm bg-success-subtle text-success me-3"><i class="bi bi-globe2"></i></div>
                        <div class="flex-grow-1"><strong class="d-block">{{ enrollment.course.title }}</strong><small class="text-muted">Online Academy</small></div>
                        <i class="bi bi-chevron-right text-muted"></i>
                    </a>
                {% endfor %}
            </div>
            {% if lms_previous_internal_enrollments %}<hr class="my-4">{% endif %}
        {% endif %}
        
        {% if lms_previous_internal_enrollments %}
            <div class="accordion" id="previousCoursesAccordion">
                <div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePreviousCourses">Learning History (Previous Terms)</button></h2><div id="collapsePreviousCourses" class="accordion-collapse collapse" data-bs-parent="#previousCoursesAccordion"><div class="accordion-body p-0"><div class="list-group list-group-flush">{% for enrollment in lms_previous_internal_enrollments %}<a href="{% url 'lsalms:course_detail' slug=enrollment.course.slug %}" class="list-group-item list-group-item-action"><strong class="d-block">{{ enrollment.course.title }}</strong><small class="text-muted">{{ enrollment.course.term }}</small></a>{% endfor %}</div></div></div></div>
            </div>
        {% endif %}

        {% if not lms_current_internal_enrollments and not lms_external_enrollments and not lms_previous_internal_enrollments %}
            <div class="text-center p-4 text-muted"><i class="bi bi-bookshelf fs-1"></i><p class="mt-2 mb-0">Your enrolled courses will appear here.</p></div>
        {% endif %}
    </div>
</div>


<!-- =================================================================== -->
<!-- 2. "EXTERNAL RESOURCES" SECTION -->
<!-- =================================================================== -->
<div class="card shadow-sm">
    <div class="card-header bg-light d-flex justify-content-between align-items-center">
        <h5 class="mb-0"><i class="bi bi-box-arrow-up-right me-2 text-secondary"></i>External Learning Resources</h5>
        <!-- Tab Navigation for Primary/Secondary -->
        <ul class="nav nav-pills" id="resource-level-tabs" role="tablist">
            <li class="nav-item" role="presentation"><button class="nav-link active" id="primary-tab" data-bs-toggle="tab" data-bs-target="#primary-resources" type="button" role="tab">Primary</button></li>
            <li class="nav-item" role="presentation"><button class="nav-link" id="secondary-tab" data-bs-toggle="tab" data-bs-target="#secondary-resources" type="button" role="tab">Secondary</button></li>
        </ul>
    </div>
    <div class="card-body">
        <div class="tab-content" id="resource-level-tabs-content">
            
            <!-- === PRIMARY RESOURCES TAB PANE === -->
            <div class="tab-pane fade show active" id="primary-resources" role="tabpanel">
                <div class="accordion" id="primary-subject-accordion">
                    <!-- Multidisciplinary -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Multidisciplinary" subject_id="multi_primary" resources=primary_multidisciplinary show=True %}
                    <!-- Maths -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Maths" subject_id="math_primary" resources=primary_maths %}
                    <!-- English & Reading -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="English & Reading" subject_id="eng_primary" resources=primary_english %}
                    <!-- Science -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Science" subject_id="sci_primary" resources=primary_science %}
                    <!-- Arts & Creative -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Arts & Creative" subject_id="art_primary" resources=primary_arts %}
                    <!-- Geography & History -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Geography & History" subject_id="geo_primary" resources=primary_geography %}
                    <!-- Islamic Studies -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Islamic Studies" subject_id="islamic_all" resources=islamic_studies %}
                    <!-- Values & Life Skills -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Values & Life Skills" subject_id="life_primary" resources=primary_values %}
                    <!-- Educational Games -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Educational Games" subject_id="games_all" resources=educational_games %}
                </div>
            </div>

            <!-- === SECONDARY RESOURCES TAB PANE === -->
            <div class="tab-pane fade" id="secondary-resources" role="tabpanel">
                <div class="accordion" id="secondary-subject-accordion">
                    <!-- Multidisciplinary -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Multidisciplinary" subject_id="multi_secondary" resources=secondary_multidisciplinary show=True %}
                    <!-- STEM (Maths & Sciences) -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="STEM (Maths, Biology, Chemistry, Physics)" subject_id="stem_secondary" resources=secondary_stem %}
                    <!-- English, Literacy & Communication -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="English, Literacy & Communication" subject_id="eng_secondary" resources=secondary_english %}
                    <!-- Foreign Languages -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Foreign Languages" subject_id="lang_secondary" resources=secondary_languages %}
                    <!-- ICT, Coding & Digital Skills -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="ICT, Coding & Digital Skills" subject_id="ict_secondary" resources=secondary_ict %}
                    <!-- Islamic Studies -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Islamic Studies" subject_id="islamic_all" resources=islamic_studies %}
                    <!-- Vocational & Life Skills -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Vocational & Life Skills" subject_id="life_secondary" resources=secondary_vocational %}
                    <!-- Leadership & Self-Development -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Leadership & Self-Development" subject_id="lead_secondary" resources=secondary_leadership %}
                    <!-- Educational Games -->
                    {% include 'student/partials/_resource_accordion_item.html' with subject_title="Educational Games" subject_id="games_all" resources=educational_games %}
                </div>
            </div>
        </div>
    </div>
</div>
<style>
    /* Add some extra polish. Best to move to a central CSS file. */
    .nav-tabs .nav-link {
        color: #6c757d;
        font-weight: 500;
        border: 0;
        border-bottom: 3px solid transparent;
    }
    .nav-tabs .nav-link.active {
        color: var(--bs-primary);
        border-bottom-color: var(--bs-primary);
        background-color: transparent;
    }
    .accordion-button {
        font-weight: 500;
    }
    .accordion-button:not(.collapsed) {
        background-color: var(--bs-primary-bg-subtle);
        color: var(--bs-primary);
    }
    .accordion-button:focus {
        box-shadow: none;
    }
    .list-group-item-action small {
        transition: color 0.2s ease;
    }
    .list-group-item-action:hover small {
        color: var(--bs-body-color) !important;
    }
</style>
<!-- ============================================================================== -->
<!-- ============== END: DEFINITIVE EXTERNAL RESOURCES EXPLORER ================= -->
<!-- ============================================================================== -->